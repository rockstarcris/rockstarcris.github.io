var k=Object.defineProperty;var q=(t,e,s)=>e in t?k(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s;var n=(t,e,s)=>(q(t,typeof e!="symbol"?e+"":e,s),s);import{t as z,a as B}from"./index.ac55fbe5.js";import{M as D}from"./scheduler.816f6b02.js";function N(t){return(t==null?void 0:t.length)!==void 0?t:Array.from(t)}function Q(t,e){z(t,1,1,()=>{e.delete(t.key)})}function R(t,e,s,r,h,b,c,l,S,F,E,P){let f=t.length,p=b.length,m=f;const T={};for(;m--;)T[t[m].key]=m;const y=[],x=new Map,M=new Map,j=[];for(m=p;m--;){const i=P(h,b,m),o=s(i);let u=c.get(o);u?r&&j.push(()=>u.p(i,e)):(u=F(o,i),u.c()),x.set(o,y[m]=u),o in T&&M.set(o,Math.abs(m-T[o]))}const A=new Set,C=new Set;function v(i){B(i,1),i.m(l,E),c.set(i.key,i),E=i.first,p--}for(;f&&p;){const i=y[p-1],o=t[f-1],u=i.key,w=o.key;i===o?(E=i.first,f--,p--):x.has(w)?!c.has(u)||A.has(u)?v(i):C.has(w)?f--:M.get(u)>M.get(w)?(C.add(u),v(i)):(A.add(w),f--):(S(o,c),f--)}for(;f--;){const i=t[f];x.has(i.key)||S(i,c)}for(;p;)v(y[p-1]);return D(j),y}let O=0;class G{constructor(){n(this,"subscribers");n(this,"toasts");n(this,"subscribe",e=>(this.subscribers.push(e),()=>{const s=this.subscribers.indexOf(e);this.subscribers.splice(s,1)}));n(this,"publish",e=>{this.subscribers.forEach(s=>s(e))});n(this,"addToast",e=>{this.publish(e),this.toasts=[...this.toasts,e]});n(this,"create",e=>{var c;const{message:s,...r}=e,h=typeof(e==null?void 0:e.id)=="number"||e.id&&((c=e.id)==null?void 0:c.length)>0?e.id:O++;return this.toasts.find(l=>l.id===h)?this.toasts=this.toasts.map(l=>l.id===h?(this.publish({...l,...e,id:h,title:s}),{...l,...e,id:h,title:s}):l):this.addToast({title:s,...r,id:h}),h});n(this,"dismiss",e=>(e||this.toasts.forEach(s=>{this.subscribers.forEach(r=>r({id:s.id,dismiss:!0}))}),this.subscribers.forEach(s=>s({id:e,dismiss:!0})),e));n(this,"message",(e,s)=>this.create({...s,message:e}));n(this,"error",(e,s)=>this.create({...s,message:e,type:"error"}));n(this,"success",(e,s)=>this.create({...s,type:"success",message:e}));n(this,"promise",(e,s)=>{const r=this.create({...s,promise:e,type:"loading",message:s==null?void 0:s.loading});return(e instanceof Promise?e:e()).then(b=>{const c=typeof(s==null?void 0:s.success)=="function"?s.success(b):s==null?void 0:s.success;this.create({id:r,type:"success",message:c})}).catch(b=>{const c=typeof(s==null?void 0:s.error)=="function"?s.error(b):s==null?void 0:s.error;this.create({id:r,type:"error",message:c})}),r});n(this,"custom",(e,s)=>{const r=(s==null?void 0:s.id)||O++;this.publish({component:e,id:r,...s})});this.subscribers=[],this.toasts=[]}}const g=new G;function H(t,e){const s=(e==null?void 0:e.id)||O++;return g.addToast({title:t,...e,id:s}),s}const I=H,U=Object.assign(I,{success:g.success,error:g.error,custom:g.custom,message:g.message,promise:g.promise,dismiss:g.dismiss}),V=t=>({subscribe:t});export{g as T,V as a,N as e,Q as o,U as t,R as u};
